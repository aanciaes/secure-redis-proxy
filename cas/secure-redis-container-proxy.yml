name: secure-redis-proxy
version: "0.3"

# Current Session Hash - 9eabc0718adccd4b2ac273d26f2dd309e79cfc51e1119c1223b6078bc219ae29
# Replace predecessor bellow with current hash when updating the session 
predecessor: ~

access_policy:
  read:
   - CREATOR
  update:
   - CREATOR

services:
  - name: proxy
    image_name: proxy_image
    mrenclaves: [792233b7ef44a0e7a985f561f596a1ce449bf9150e4863e2cc29dc0653829450]
    command: "java -jar -Dspring.config.location=spring-application.yml -Dspring.profiles.active=prod /home/secure-proxy-redis/secure-redis-proxy-1.0.0.jar"
    
images:
  #Proxy Image
  - name: proxy_image
    injection_files:
      - path: /home/secure-proxy-redis/production-keystores/proxy-api.p12
        content: |
          $$SCONE::proxy-api-tls-keystore$$
      - path: /home/secure-proxy-redis/production-keystores/proxy-attestation-identity-key.p12
        content: |
          $$SCONE::attestation-identity-keystore$$
      - path: /home/secure-proxy-redis/mrenclave
        content: |
          $$SCONE::proxy_mr_enclave_secret$$

secrets:
  - name: proxy_mr_enclave_secret
    kind: ascii
    value: a0bd510c2fce258135377f7d6869600d45c37d6658c43622ec4a2b6344bbd06d

  - name: proxy-api-tls-keystore
    kind: binary
    value: 30820ac002010330820a8606092a864886f70d010701a0820a7704820a7330820a6f308204f706092a864886f70d010706a08204e8308204e4020100308204dd06092a864886f70d010701301c060a2a864886f70d010c0106300e04085cef546d2d763e8b02020800808204b09a8defa729a33ef76f0d7e718bcbd596a905174bf99c5fa02b11fe0bbf3930df2a9bd4c730c36719a5fa207ea991ea25533ef1b88be47a8b50ff43cb830fd587f0b4c816b2e0472901a8e15e959a4c9dac8ed17d7b34c0f6201dd87d3825a64b2ecca50cdd7da4bf3b5c48664e93e2813203fcadc1975ea2dc9f94e5fcb47ce5b35dea44891689807341abcc8b8f98df2ad7e30f6d99a762eb6d1ae00aadf16a576a585da73483b1aecdfdc057569562d4460b5c0570a6046533c086b30ed0d3ae9a4792ed311b91d5448f2ad77b76e5b82eca5ab3db629687d3e44157a34c1fdf5339210d6bf344cc8fd9a0c9af89d0c8901fb54d17e367ac9bb33a8494fe3f391ecc50b525ec93cd1674664c10bdea918957ec8011197dd799643ed43924ef235a165c11749ad42d7b2c54a6a6a4eab4f15d75921941407cd811d4cbd62b89763563413fbe0e0ee31152c4a836fc831f7b1523c0e2bc272713a256e007780edf264c0423fa55af6ba894f4c47f14def2f46e61427ef51cd360e0299d452029a852c82c0c5f7e669f3a7fd65ed32722b0db01ebb5c8fdc994dd61cbe068d97a342f11961ff498681b66c87fffe881435ffc21aea1910c6de81be7e1e2ade8acccbdc3587bb17b7b36e34416ac7d71439aceb83052f8f2a54d91162a32f42f95d62835e0a719022de3f98c49a9ac37606a38f69ee43449cf040e7f8cc00398511e45683971cc00a9e60bfd82f2fd4f38623b81e352d0be6ad680fae16128614ac060e4441b91964d7be98a79a76da7812a014ca5ce2e45640bc6240510334d94f88c32984fcce9a08c6cad923900603030f0982a3c248c94ef27469bb3552cdaab7ea569300c4c232ad9683b0199538830329eb1f72146c48817ba4592a3adaa01aae46a48ac57f31908d800a595ee8fae2be1f55ae8f9ac09f04734808aa41d2cb2ee1780e486997c0f13d905554f094efdd6361dca792b4863d33d5a61e9ae2656a71bd61421f75dc089e1a78807fe629b4870d5ae2ed4116f8bb85125fdb91aa05524df7eadbcdfafd68fe7957bee6f48a6112534db933d2665800ab4280d7b7f4e8421a8761d579396133e6d28e9430fc4ea391930b66a7cab60bfcf19757ddb46547129bbdc64f77e9411989ad699cf30dda4fe62b135023d8f8b4ed83ee55947f22a8f6f8b1064e1127ac6609663abcca32311e3ce5871e11f38bb9ff232ea88039b2d06b1a07516f2fe57ad932fdbb3e105e9c53bdf41385ca479f4becf0148e58333ede84a99945c3218d9ac6cc0b51d37d877e22576ca54b85e758ec1e2a209957ef99971016120a51d8e49cef0101e2c681e92747a065ae83155214ec210420007e114accb792a30f39f9b98a47870402b2ea6f3248b1fee79b3dbc1ac8f73632e6c2364967e312d399ca1a981b615632596762f4bd81499e6df937fa3b92d66b9231c3a65782aa11e797a135bcbf36b5d35b0e22232d1e6553e2f3f1063350e3e7390fe7ee789865924e8d2b67d190185b484924ecf4bed9d4279b482681b70b234d106cefc01dac53ade173b2be708f9551d8aca97f7e9b7cb116b518a6829d4f6ec093d9d9f8d4a494cc61423a59aaccddc4285fc7058e825b4a63561a6bd93ca5e23cc60d3ae1a1f736d7d0c7e3ca03335a137cb00db745c5832e16a53c4e092b4cee5526a6b96a6543082057006092a864886f70d010701a08205610482055d3082055930820555060b2a864886f70d010c0a0102a08204ee308204ea301c060a2a864886f70d010c0103300e0408a8072b3bcd28da7c02020800048204c88da5de86c2aa073008a7fefbda5e0bf24c58c40767afa690a24829d9a61a5ecb44932f9a7611ed7f4df8fa1b63c671422f092bf1583fcb996cd038e550b23c7f6bcb50539707ac5b9aa5ebb631065ef0f95940afa1cf3879cc10cd8e1bb18dcae0dbb3083b056ca2f83ee31846543672fd5cb431554c7d4ecbb01b29d5f58036f91d2c472675ac37ebbe6761353dc3c2173078fb5c2d3f5a080c87edf76cc92f6441f14086e48836b0c402c1d596e60b2e4e6ac0d991d6f1fb96b299f08ee4798e0ab37fb9d539d792f4b45f4a7a425ef66983e71be725e695ce0a66ec5efd320742b24a72f10f054ba52be299a49a772c32524ad4b33a1e04b559a9b7d1092f39d52d2dd596880e43363b027374d08885cc7c140f34ba76f5188f7dd6c0540d8298653b47fd1f26ba7942066f0554e079a31c719122a7fcf391f48da52ac8b60c80181e32555df99bdb54b80538e3f1af1a3eace5d8059639f49c4c2691d2ef1fd7ff68cfc982761cd921b2195a54654689995211ce9132ff251e7909edd4496a71fd59d92670f6b478a4524eba67380d3e497f4164815ee46254c0a632254cbddd13aa1fbda9cc32903d2a870c1b3a57127550ef8e5d9a8791cf70e46f8bdfc8977e8104042e40ec9a1f1fe792026649675a5f5a58adff04bf56dbe5d2a6ca8d239997870b9825f421669f76f945913a46a137f698a7689a1d3fca9e897ff156bb75b1d2867c7a6bd6320b865cf22087cbe2627d59d804bbd91d92103fef032fe0d2e18e654d9b059c303c1fb7ba31327425fdd09d0d109936e76fc319c42496cbe2573227cb131fbbdb3e41ae5e5b2c5ff7babf8a456277ab41a074cdf4b81ba53219972c4697169c8563049a5a9abd54171619b36b2f1e886ed74144f0ad41913994980011a85f68451f2ab9bd7f073d45f23dfa6f9f872763dd82bdc3e92200efd2e153abe5524b8d07209f39883e3b3de4fce125b668dbe8a454e794b195fd4d6071a26a6743d24e915f158fd8b40cbba46275e0a1f6285508ef75d939afef06680b3f8950dde8aa6cd18cc25e21a5cb4f2d6d4cdbb87d57b8fc0a0da3a43d297d030130fa8440860b90290e90d251207ae1594c6876f9d31a1ce412dafa4850a68829f50bfd9abeea4625982e99f4f3602b20d4a0a0a88ec1abd62972fb736a36a0b99e7691d67eba685bc2268776b7eef7aa86f3333939dc5b91a610402d1cd221a0181a74934791e804ffe818f9639591a5713b760eb3067a515ab816cbfae25793015a4ac4c07849dd58bdc9d8a357c4b3fda0c3fa1ed217914736e35a72ba0b39cc8b8fa7c5ca6902ad0c17c8aa3b09ab07ff044b7d7716f5deb82cb0cf71f7f94a88d6666f7d555d8c1a66bb9b77275ea3d99da2aec0c99c5aaf929f503daee62fd43bb9a22967a193b952739acfd354cc881b69828513fd927ab5bb03408baa7b60fe0e17b983b7aff8eb470b4fd8787290c72e18f29ef2e6fbf9057d7aed7482bed82e683e3677f4df94c3c8e2950ed3a87519b42aeccfa1c506100291d5cc730bc92399cbd494c6c0fd3bcbef9f7a40fc1118decf616dfc8c56bc6cb8eec16d28c752d6319f4f92994308ba7fc0da9989b75c5e14b98608bcd1e47585d42542d01fbbd865eb0002601f3a492fa4c61e30bf01545446a401da09decb5ab58d2d4eeb9a204a1bf7c3ee47af3438ec1de5989458f1015963b35428b7e8314b0526433154302306092a864886f70d01091531160414909dd485b5b4f50e12cba971979a75450440c687302d06092a864886f70d01091431201e1e00720065006400690073002d00700072006f00780079002d00610070006930313021300906052b0e03021a05000414697386830b6bbcb342ad8f9b08f480b1d71ca173040829caea567cb06d8502020800

  - name: attestation-identity-keystore
    kind: binary
    value: 308210b60201033082107c06092a864886f70d010701a082106d04821069308210653082064f06092a864886f70d010706a08206403082063c0201003082063506092a864886f70d010701301c060a2a864886f70d010c0106300e0408d97c7add17df9a100202080080820608589bd5e8790c1bcfec9a0b816db304c793a0c5597bd51d13ff71a290a52d9f88fdbddb63f0ab76b2540b44404ec1c2f8dc610a4476ab81d8d924939e7d6f7a3b55fd13018a64869f9e77f431f9b974d0da3204afdab87e447e387b32171b2ae2cc16a156181084b2e22f5ec889b187e52717d0c6e3d56a0a3204945624dd1246d36f7ff4bf37790b6013b9fb1f34db73d45530b209d4384ca895f29154fcb65bd6595d5e2737b48c7e3d168cee701302f8d4df2c972b5517a914ead94dc86bfa0b6a27672f54f65bf6af40c6d1a2c013c02220a1e5d8bce2a8eae92af713ec11ac8f4ca45e87bcce360c29d3ae9184c67b1a078e248d5b34e19b92c54e8d499a5dd9e23f2355b28fde28f2ae4272c37fed680b1002b7a72b69cf89288f3758649e1a3a83e2d994cd39d832ccd4cf201c60de7fcc521dc4f63b63685595a52b3603f43423a857db29ec691739521860c8f50bea746113804f7c0c741268e25d01c166c5a156bf4bf408865bab7daa23fdbc537450c9d839c920315f43e3e75778ae30998a59c1977967adb1c77ec2d270b70e9ee2b79156c64c54345c742832798b538afa5640b863906ac36e2e8254c673d17f17d3a948b0d49975401b48378628f824a802cda3b93095123943d5620efe82cd4a407fb836c29cc01afffb3fa776210432e94f36e6952b8a6f19c8a6593bf156ae906a115407a8a3b4808dffca323d8b8ecc087e4f815417a492836d13d68ae6f2db33e36e0f8701bf72877bab85a5991f3462aec373d0cffb8f825db7ddc9335611bf0e429bcf46f21c209a0700458ec0504d6fc4bd62283cd0e06e89b4f78447dcd365c52720a3289a7ac91a4d30253c9ba27283bdcc071ad5209def0da00a73ded8aa2a54d699ba36c3195005d385333675345a3a9be407d99fb23df3e15b5ed150c4309d41f76eb66339b0b9f2cf86cc091d04ce4f110994614a6572949c906eccad75ff0679602ed1fb88463ece172d92bac41a3a0e08594f61bde647d35c2ad64087b268c435b00f7685e0f15aff1396204ac27397b037fa2527a09970220903dd6b8e5fc5bc77985f6d8e4b463b5480a253dfb2ac53d6ddf993369f2c1fd79ca63a52354c24bba42043816fd856d7f7f99dba11e519d2053692d8c66981878a87be6bfd0cf16944cd52dba65a980a9fd9f2aa75e3a990a2261507464ce0c48aba83a3807e7bceec1c3b84ecf0e599813ee2d50fc1d9e958a2c2f73618bb2ed72c64fb8e80e89a9950644e2f843e5be15264c82a63b11057ec64268b144d5b7a0d4081104b54f576bb8c5abe29f3e0d70125f6d9efdce796f82ee27b3148fe53eb6ed42f43736a1de28ea8cfbee2fcdc42b18dc31d35f11e5ae1b7a68b989fc231bce56a8bf1472ddb71a1d07c55fc0b58939f30ff3e9adffa38753f34405c2dd154501ef8e830048851108ad6e564d89b5fd64747ab0487941ec67d184734536799bccfa0019dbadbfa2a390ce7a562e8f883ccbcb15ecfe15a173b41fb9bddbd0b717d47f0ea814ea07d1c0424d05aa700fe52433a0a508a750fd31b98d17ea04fd9057c5eba3b74f3cbcdbcd1b6b318bc9e843d22b0e4241f5ac5982f2bd04e806d5a12d60abb0e882c3dbfb3bdd5201a5a9a46a7eaa7f578fdac496bd1d1616c23b428a61f5183c629d9d4b46443f2e34859c2051b68379e8e8d18e8680f7ee20c12597e8d7aa55fe826dee11ad92870a64202e7741f053b6dcc7934173ca7883718455f1c1aa21ce6fc7326734f0f2c498f231dd41aec8cb4aa52144b15118853b6927667aa686b29a0ba518dce2ef0ad33933407e635ed97bd8624f4ad3accd54515c68c5b63ecf36efaebf7b28e983a80c0b9cc5f87563a14d94c4f3b443125923710f5a12daab76863db4c3bbc9f135d28841ff43b17b35260f84728ff6834ef124348630b816585b8b485da6498ab57fa039a02138b47917e8652534d08aee5e8b7cff42e500e451bee0196ce7640f02c158446450fa72707642112245f5eb502bbeb2d3f81921b944bfe829961b25229789ec065b9e3960f20c4b755dfbab81e8815ae7955a895172152a6db76cf6786423c2f1c5f0fa7e2535f3440ae900ea2df71f1b5d00404aad87cd40b391a56d9a1ca0efa659d90a6f8b0468a4a0070bd54c4733b41d701d8d76408ef7630820a0e06092a864886f70d010701a08209ff048209fb308209f7308209f3060b2a864886f70d010c0a0102a082096e3082096a301c060a2a864886f70d010c0103300e04089034bb744ee6275d0202080004820948db5b7b8b31747c7b0131c94eef1e3a7f2157b506e749ed32a8fda21a67318bb353c79be7ebe11a24ee6df55b46f6c720b5bfb199075e1f0caa1061ab413a2f3d85c78493f3f745adaa916bc739ef552d42c185c0e177d25815607e98a5dc57e53a54333939eee8c5189f192f6808d12da73b516a938cde6645966b5e90e78fa80b8dfb564ce027101b95e83b03aa1d1c8a5175eac06954982cf3816831ac7f3bc44d638cffeec044242798294e9136c382d0ae749a88b2a5dbd3a3f784d3355ca39d6293f39bb7d0cb80f25c3b3c20184274cd2c1d6258b15722be68c63932e7f7f3245ce461b70799c7fdb03744bbc94298a07a8a57c4ca39b0053a2bb53a1071d672c7aed185f7dbc8ffecb3340985b171b5fba9764dbf67d5aabab34a9d5381ee7926c60fe9ba59519b054b56fc79178c610e83cc3e9a84d741f725625500244d30c417c3863286f5c0c0554fa18638e490e2fc32c755afda28e49a9827bfecdc72059278eece32b201629eabd4dc93d8319fd2a4eba419975dbbb7028626db5766c5f1298b148e953dd1939ee38e4098a76c4c717bad9f75e8151719e38c8e6b0b7e807eec8ac72bf88daa9519a1bbc8846ef835bf246e51e04fa5936b56b9474234e2b9c603c6406bffb61d60bff510017015941582e52598e03706fee738d68af1f4a3e441ce07c623edc46a98b95149905b86afaa498dcd1bf52056ba3fd73756b52df83b10da50ad8ac938d32ad84c1720177b90beb08f0e271ce9a49865f903b13085ae330691f60e8ac164e4ed195ed799cf5048056aa68f8a9d0ed917a2650ca02ec60bb61185df5c6a514744cea0ee29138d7f7159cc37c65770199a1d81d92d98b4541e24abddd3db293cfbf51ca3f69de2fc192680a404b2ddc571c07d96b48edb2ab3530906606dc7edf24faa048955dad277dfbd9658106f812f611cde5f527f2b4dd7cfc4e7ad7f9397b7964e29d80d85ee2e5739afd7a9f93664b03b57905a79243d15d0109ffe6faaa93cc195f2dd143a68c1e79eac415f005d822780f4a714e90c4845b94442025cd9e44ac3d1cfe7c9c765f4a388dbe136bc8b40e490b1df982554091d469c7296d440e79a34fe2d95982bf8ac079f02a19ad0073aaaeafab3d33b36098fd2268eeb406c5b5e8a9888f7690a33e025a9aab4c76a8f478fd78e068850f26ad98960d800d910f3f7f4293a70ed2e1ea5b5df7f30843d6eee4049884f3374e22a4229a158c6b47a19ae87df9a0cb71ba8e64e13ddc617f6154b5e3787d5bee198e4ce7996e30648c3b7a190018456892757097832657fde01ca854229b494183b1c99fbef783f8086b5916af9f3e9cbb30963f310f7dbd16edb9f35caec61296a104db662f5090d34a7ca08deb76ed697e2d3a5430753a6ee9f65f9c9f973a7679686b63125d6286a4a35f3b92f7963c1c60cad2d86cc9ba7ec9b985612eee19bf72877342a1b2a2faad2796adf054dbd18e6ee24406e335e5124d2d882484d32d0eb606aed47ea98e9d228d1136a683dbe1216780d0e5b12529be37690a32660e41514785873852ae0681191d7cdf095168f72c95fa398ee8ca28768539e1ea81e7c3a50bb56678564a30db8029ec36fcf6ac5454deb785d775bfe835df6bdea442fa23172ee1153196026531e9d82cb9bc545d4d03b85894a487f102312ef65db70788bea30443352086c5d746fff620c558f5d6f42ede15512de24a86d3e7d9194a89e16cd45ab8b1e9fb69856be5d499b5d5bc84beb6196a395d9be8afcd6138ed805670d9ccb23d6ca403cfa808c138bcaea133b25bd5f93975b64bf222a6f8707d18f3d785717255bece30f16fc51c4865bce6ce0bf7835c06a6c833526608297fdd9d422995db012f801f373cb84fa8fd45570f775874a7eea0e132093b2669d9736648885f0f7065f5fb374792dc2ebdb53fc6e4d79dccf459a9eb01b2faf4182b8008c4e5daafe68c340759da8d1e5cfcef6ba7841eceb8bd5cc4769ce94ea0d78b4cc3328dc6a58d6bc38a40542b43f51dd95efe0dee79b06658c38e66789121632cd277a1cb03d4a0dfad9ad98115b36acb43d2b40b9805ea552cdb749ea47df526f0a9f74f9d98fc81e1c7fa7d353e29d4c65548b86e8e7bdd80e8c4df26aee5128f26cd063c0c66c021692c58da64ddd61eaaff45c38a145cf6e881a5b941c138c216d3d683fbd2480b058521771a08bb1bc7299edcd1f05e6afa115fdf8649ea38e2a4db57956f192f39a33d66ce34992801451ee760b3016c4a1c50ac08ef788462c55ec4fce8741ab83b40c4121d7d2917e1c2f684edd767b3bbf93163e6299050e2009337ae0cfdc1e5452a555a456aae19a0f72bcc4ee825f6060e0eeb41d4cb8f539069de9b7da40d9f02ed676de638bdb11ee76da8b79ec6501a7440d7fee2d73b0df08d40c8399ca0203e1920e6dcd1a1a88e7cf562861a9776f355ac32ff15161c731f53764494df519d16609f1e94d661d6cd29734ba8a59d8cb24a3a8e6b0d35d95a1c18b7b9584b0af7d898514390fc197085dfd9eb74a6db1dc69eea0407a50124bb0c3649b237a40586968db31cf2e0cf7850b64deeb50f659c43bbb1e647c8940af31931edf6cfdd778201a2926d517eab37e576ec96acfe760c87ad71254261e926359da9d520747983b5b05ba2139d3d4b9c7fbe44ec80734e1834eaee8deb4fc5118208f8e813e50caee7a8b1f2ec97660e21c4fd8c7b5f188b193b217a17bbe9d530ea9ed032a1c4bca1e63d2bc0d664a193f2b99076bc850da99e5053801a51d597ca3e3b3db7c84689b5edeae5438e0241aca3cf7249561b26be283f988b9aef55dac53913789e62c4a5022539ec312b83cd6a5fffe64352e0797935022003cea095283eac06e4a436054325b9fc9178d2f7d6dfd08fe013c59c030bd172540ad3f85c89a976d3048f27fecd7cce5fd4cb117d1ed5ea849d8e275fa106465bad41c46fdefccf6e9fc2e962855646ae53e1fdb99c85c9d15064fc9749aca204c0bd41cc122f815bca7d6923e3d0fa4d3858acc2e06aa1b40fb46c6a10b5756c996848895cdc878cd4998b07db52181f7885544d8cf2f0538be359609618145d47036fd518e5c2ae2457e1f8a354e9f6be83089e96a67e9fbeade3ddbb38267d5b37d9047ce137385bd6d16875ab51f93d7c7d48a0788779c4424017bc696f4d10fbc027ebb963e0a80fb11bd1e53dd3866a0bebcc11c11e834d484ed50c2d4385d7127525df1ca8792e3a76476c929cc493e60a177881cf548c2de2b28d0ffd22ac1b8b4c8473bc228c691639372ce005066d4d0c20ec833a1099fdbd130376a28ef170d07a28b4a3172302306092a864886f70d010915311604145637e339e161915ab181ebf8b4543454bd16a268304b06092a864886f70d010914313e1e3c00700072006f00780079002d006100740074006500730074006100740069006f006e002d006900640065006e0074006900740079002d006b0065007930313021300906052b0e03021a05000414741695417d7d9eb8f970bd356ce6a595b61555370408304bc53e95a5537902020800

security:
  attestation:
    tolerate: [debug-mode, outdated-tcb]
    ignore_advisories: ["INTEL-SA-00220", "INTEL-SA-00270", "INTEL-SA-00293", "INTEL-SA-00320", "INTEL-SA-00329"]
